/*! Greentree - v0.1.0 - 2014-10-11
* https://github.com/GGGGino/greentree
* Copyright (c) 2014 ggggino; Licensed MIT */
!function(a){a.greentree=function(b,c){return c=a.extend({},a.greentree.options,c),this.opzioni=c,this.contenitore=b,this.items=this.getItems(),this.setGradoAndGetMaxGrado(),this.setFather(),this.doTree2(),this.contenitore.children(this.opzioni.selector+":gt(0)").remove(),a(".riga").css({clear:"both"}),!0},a.greentree.options={selector:"div.ruoli"},a.greentree.prototype={getItemsNumber:function(){return this.items.length},getItems:function(){return this.contenitore.children(this.opzioni.selector)},setGradoAndGetMaxGrado:function(){for(var a=this.items,b=a[0].attributes.grado.value.split("-").length,c=0;c<a.length;c++){b<a[c].attributes.grado.value.split("-").length&&(b=a[c].attributes.grado.value.split("-").length);var d=a[c].attributes.grado.value.split("-").length;this.items[c].setAttribute("riga",d),this.items[c].grado=d,this.items[c].attrGrado=a[c].attributes.grado.value}return b},setFather:function(){for(var a=0;a<this.items.length;a++)for(var b=0,c=a;c<this.items.length;c++)0===a&&(this.items[a].father=0),a!==c&&0===this.items[c].attrGrado.toString().indexOf(this.items[a].attrGrado.toString())&&(b=1,this.items[c].father=a)},doTree:function(){for(var b=1;b<=this.getMaxGrado();b++){for(var c='<div class="riga riga'+b+'" riga="'+b+'">',d=0,e=0;e<this.items.length;e++)if(this.items[e].grado===b){d++;var f='<div class="contItem">';f+=this.items[e].outerHTML,f+="</div>",c+=f}c+="</div>",this.contenitore.append(c);var g=100/d;g+="%",a(".riga"+b+" .contItem").css({width:g,"float":"left",textAlign:"center"})}},doTree2:function(){for(var a=this.items.length-1;a>=0;a--)for(var b=1;b<this.items.length;b++)this.items[b].father===a&&(this.items[a].innerHTML+=this.items[b].outerHTML)}},a.fn.greentree=function(b){var c=a(this);return b=b||{},new a.greentree(c,b)}}(jQuery);